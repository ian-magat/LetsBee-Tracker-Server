
//GET ALL BATCHES 

DELIMITER //
CREATE PROCEDURE sp_allBatch()
BEGIN
SELECT `id`,`batch_num`,`current_location`,(SELECT COUNT(*) FROM tblitems WHERE batch_num = i.batch_num) batch_qty FROM tblitems i GROUP BY batch_num ORDER BY id DESC;
END //
DELIMITER ;

//GET ALL ITEM BATCHES 
DELIMITER //

CREATE PROCEDURE sp_allBatchItems(
	IN batchNo VARCHAR(255)
)
BEGIN
SELECT item_no,`id`,CONCAT(LEFT(sender,1),'*****') sender,`sender_payment`,CONCAT(LEFT(receiver,1),'*****') receiver,`receiver_payment`,`tracking_num`,`batch_num`,`phone_number`,`declared_item`,`weight`,`dimensions`,`quantity`,`current_location` FROM tblitems where batch_num = batchNo;
END //

DELIMITER ;